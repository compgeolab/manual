# Computer-Oriented Geoscience Lab Manual

This document is designed to be a reference for lab members and collaborators
as well as part of an induction process when people join the lab. It outlines
our practices, core principals, ethics, and expectations.

**IMPORTANT**: The **first thing** you should do is familiarize yourself with the lab
[Code of Conduct][coc], which applies to lab members and collaborators,
both within and without the lab.

**The manual is a living document:** lab members are encouraged to submit fixes
and improvements to it.

> **Tip**: Use the table of contents icon next to "README.md" 👆🏽 to quickly
> navigate this document.

## 1. Induction

When you first join the lab (ideally within the first few weeks), you will have
a meeting with Leo to introduce lab protocols, set expectations, add you to
communication channels, etc.

For a preview of the things we will do before, during, and after the meeting,
take a look at the [induction checklist][checklist].

## 2. Expectations

We intend to foster a collegial lab atmosphere, with opportunities for
spontaneous discussions and creative opportunities.

* Lab members are **not** expected to sacrifice personal or leisure time in 
  service of projects.
* Working long hours without interruption can lead to burnout, exhaustion, and
  overall **impedes** the type of atmosphere we are trying to develop.

Lab members should endeavor to be good University of Liverpool "citizens",
including:

* Participating in seminars and all-hands meetings.
* Contributing to department projects.
* Collaborating with individuals from other groups around campus.
* Fostering new collaborations both internal and external.
 
We strive to be a part of the intellectual community at the University of
Liverpool.

> **Note:** Human resources guidelines take precedence over this section.

## 3. Practices

### Openness

Unless there is a *very* good reason ([PII][pii] or other restrictions), work
should be conducted in public repositories on publicly accessible servers such
as GitHub.
This includes software.

Paper repositories may be held back as private until time of first submission,
when they should be made public for review.
Because it is expected that repositories will be made publicly accessible,
including history of development, lab members are required to behave
professionally in them (including commit messages, issues, pull requests, code
comments, etc).

> Many journals consider the content of referee reports to be confidential. As
> such, unless the report is explicitly open, it should **not** be added to
> repositories as text, commit messages, or comments in papers.

Grant proposals developed internally with no external PIs or Co-PIs should be
made available unless there is confidential information.
Grant proposals developed in collaboration with external PIs or Co-PIs may be
kept confidential at the external collaborators discretion, although our
preference is for them to be open.

### Data and Code Sharing

All data and models generated by the lab will be made available in both raw and
processed forms under [CC0][cc-0] or [CC-BY][cc-by] licenses. Except where
constrained by external (i.e., "upstream") copyleft licensing, all software
developed will be made available in source form under permissive, BSD-style
licenses. Source code will be made publicly available on GitHub (or similar),
with additional backups possible. Every effort will be made to preserve
integrity and accessibility of data.

> The above text is based on the
> [GBMF DDD Data Sharing Plan](https://doi.org/10.6084/m9.figshare.1293561)
> by Matthew Turk.

### Reproducibility

Unless strongly prohibited by external concerns, the necessary components to
provide reproducibility of a scholarly work should be provided in a publicly
accessible location and, potentially, as part of the scientific record. In the
case of an method development paper, this would include:

* The source code that implements the methodology.
* Analysis code that generated plots and results from the paper.

The overall theme here is that of reproducibility; this is not the same as
bitwise identical reproduction, which is often unavailable because of
constraints such as order-of-arrival differences. The additional overhead of
making work reproducible should not be onerous compared to the other
expectations, and in many ways (i.e., plot generation, good note taking on
data, etc) can reduce the overall effort of developing papers and workflows.

We will endeavor to respond to requests to reproduce our results by providing
necessary technology and data, allowing for reasonable commitments of time and
effort.

## 4. Authorship

### Publications

Projects that lab members bring with them **do not** automatically confer
authorship rights to either Leo or other lab members. However, if work is
conducted on them during the course of being present in the lab,
acknowledgments would be appreciated; funding acknowledgments are necessary to
describe the source of your funding.

Projects that are collaborated on between lab members do confer authorship,
whether that collaboration takes the form of intellectual collaboration,
technical collaboration or data sharing. For instance, writing code to support
analysis or simulation would confer authorship. Sharing information during
group meetings does not, although if material intellectual contributions (i.e.,
new directions, solutions to problems, specific and directed project ideas) are
made by lab members, that would confer authorship.

Please keep Leo apprised of the broad outlines of your external and internal
collaborations. Leo would very much like to be involved in the development of
external projects, but this is not strictly necessary. It is certainly not
necessary where lab members are providing supporting roles to external
collaborations.

### Project Ownership

From a social, rather than a licensing or intellectual property perspective,
when a project is developed in the lab primarily by a single participant, that
participant is free to continue developing and assuming project leadership once
they have departed the lab. In fact, developing projects that mature, grow, and
may contribute to their future career is a key part of the process of
scientific development.

For projects that are collaboratively developed with multiple roughly equal
participants, leadership will be decided on a case-by-case basis, erring on the
side of providing intellectual freedom and empowerment to earlier-stage
researchers.

However, projects that are part of a strategic lab direction may continue to be
developed within the lab following departure of a primary developer. In such a
case, decisions about "forking" or bifurcating development will be held on a
case-by-case basis.

## 5. Ethics

> **Note:** this is distinct from the [Code of Conduct][coc], which applies 
> both within and without the lab.

Our actions should be guided by the ethics of participating in the scientific
community. This includes prioritizing our professional obligations over fear of
being "scooped." For instance, it is *completely unacceptable* to interfere
with the peer-review process for a paper out of concern of protecting one's own
work (i.e., "sitting" on a review for it, making unreasonable requests to delay
publication, and so on.)

When other researchers request assistance with software developed in the lab,
we should attempt to make a best effort to assist them. It is not unreasonable
to ask for authorship, particularly if the collaboration is extensive.

When authoring papers, we should be providing citations to all software that
assisted in the development of the scholarly work. While in the extreme case
this would extend to the operating system level, in general it is acceptable to
cite the layers of software in the analysis stack (e.g., NumPy, Matplotlib,
IPython/Jupyter, etc.) It is preferred to directly cite the canonical papers
(often described in `CITATION.txt` files) for software, but acknowledging them
without citation may be sufficient. Citations to data DOIs or publications
should be made wherever possible, and where not possible, should be included as
footnotes. When developing software, we must make a best effort to cite which
pieces of software and published methods contributed to the development.

Plagiarism is unacceptable in any form. This includes "first pass" text
included in papers or proposals; when "first pass" text is included from an
external source, it must be clearly marked as such to ensure it is not
accidentally included in the final product.

## 6. Communication

> This page covers in-group communication. **If you wish to contact the group,
> please email [Leo][leo] directly.**

How we communicate:

* **Slack:** Our [Slack team][slack] is the primary mode of communication for 
  quick messages, announcements, reminders, and organizing meetings. 
  Messages are ephemeral so you cannot count of being able to read messages 
  older than 6 months! **Use email if you need a record of the conversation.**
* **GitHub:** Each project is assigned a repository on our [GitHub account][gh]. 
  Reviews of code, text, etc., will be done through the repository. We'll also 
  use to set goals and tasks.
* **Group meetings:** We will have *short* monthly group meetings for quick
  updates from everyone, general discussion, announcements, interesting papers,
  and informal chat. 
* **Individual meetings:** We aim to have weekly individual meetings to discuss
  project status, goals, and work through problems and ideas.

Group members are also strongly encouraged to have meetings and messages with 
each other. **Don't wait until problems build up to seek guidance.**

How we use our website:

* Source code used to generate the website: [compgeolab/website][website-github].
* Members are expected to post **short** news items when they do things of note
  (join the group, graduation, publication, conferences, awards, etc), as well as
  to update project and publication information.
* When joining the group, please submit a pull request adding yourself to the
  website. You are **not** required to provide a photo and contact information 
  (but you certainly may if you feel comfortable having this information public 
  on the internet).

Social media:

* In general, social media can be freely used if in line with the
  [University of Liverpool Social Media Policy][liv-social].
* Lab members are encouraged to be respectful and kind while participating if
  they are representing themselves as lab members. 
  
## 8. Health resources at Liverpool

**Your first priority should always be your own health, safety, and
well-being.**
No project, paper, grant or collaboration is more important than that.

In particular, time as a graduate students and as a postdoc is 
[known to cause undue stress][grad-health], resulting in consequences ranging 
from mild to extremely severe.

The University of Liverpool has a number of resources that may be of
assistance:

* [Student Services](https://www.liverpool.ac.uk/studentsupport/): General
  information and links to the different types of support offered to university
  students.
* [Mental Health Advisory Service](https://www.liverpool.ac.uk/studentsupport/mentalhealthadvisoryservice/):
  The service can help you settle into student life and offers advisory on
  mental health issues. **If you feel concerned that you or someone you know
  may have more complex mental health needs, contact the Mental Health Advisory
  Service** ([counserv@liverpool.ac.uk](mailto:counserv@liverpool.ac.uk) or
  call `0151 794 3304`).
* [Counselling Service](https://www.liverpool.ac.uk/studentsupport/counselling/):
  The University offers drop-in counselling sessions. **This is not an
  emergency service. In the event of an emergency call 2222 (internal) or 999
  (external)**.
* [Self-help Information](https://www.liverpool.ac.uk/studentsupport/counselling/selfhelp/):
  There is a lot of information on self-help with tips and information.
  
## Coding and software

Strive to follow these standards:

* Code should avoid being "too clever", for example clever abuses of languages 
  and algorithms that cut corners in the interest of marginal time savings.
* Clarity and maintainability take precedence over performance to ensure that
  the code can remain useful beyond the original scope of the project.
* Tests should be considered mandatory for new functionality and bug fixes. 
  These tests should be part of automated testing suites.
* Use [black](https://github.com/psf/black) to automatically format Python code.
* Documentation must be added with any new code and should be accessible to 
  newcomers. Include examples whenever possible.
* Comments (not including markdown cells in notebooks) are encouraged but not 
  necessary. Code should be as self-describing as possible. Where complexity 
  is innevitable, comments should allow anyone to  understand the shortcuts and 
  reasoning.
* Include citations to algorithms whenever possible, including links to online
  resources.
* Docstrings should be added to all functions and classes in Python code.

Licensing:

* We value respect for licensing terms and ensuring that we comply with them at
  all times. 
* All code generated in the lab should be open-source with a permissive
  (non-copyleft) license (MIT, BSD, etc). 
* Our preferred license is [BSD 3-clause][bsd].
* If contributions to upstream copyleft (GPL, etc) projects are made, those 
  contributions can be licensed in accordance with the upstream project license.
* For further discussion see [Stodden (2008)][software-licenses].

Languages:

* Use Python for most software. 
* Experimenting with Julia and other languages is acceptable and even desirable. 
* For code that needs to be optimized, the first preference is (in order): 
  Numba, then Cython, and finally C.

Project leadership:

* When software is developed as a result of funded activity, the leadership
  directions will be set collaboratively during the proposal writing process and
  between lab members and Leo.
* For externally developed projects, leadership is as decided by the broader 
  community.
* Decisions regarding strategic direction for software projects (including
  algorithmic strategies) will be made collaboratively.
* For technical directions on lab-developed software, we operate by
  ["lazy consensus"][lazy-consensus].

External projects:

* We strive to be good "citizens" of the broader open-source community. 
* We encourage lab members to contribute upstream to open-source projects.
* Projects developed with external collaborators (e.g., 
  [Fatiando a Terra][fatiando]) should have their discussions held openly.
  This can help discourage the notion that projects developed by lab members 
  are not community projects.
* For more discussion about this topic, see Matt Turk's paper
  [Scaling a Code in the Human Dimension](https://arxiv.org/abs/1301.7064).
 
## License

The manual is available under the
[Creative Commons Attribution 4.0 International (CC BY 4.0)][cc-by] license.

----

> Based on the excellent [Lab Carpentry][lab-carp] blueprints, with material
> adapted from the [Data Intensive Biology Lab][dib] and the
> [Data Exploration Lab][dxl].

<!-- Links -->
[cc-by]: https://creativecommons.org/licenses/by/4.0
[cc-0]: https://creativecommons.org/publicdomain/zero/1.0/
[bsd]: https://opensource.org/licenses/BSD-3-Clause
[lab-carp]: https://github.com/lab-carpentry
[dib]: http://ivory.idyll.org/lab/
[dxl]: https://data-exp-lab.github.io/
[checklist]: https://github.com/compgeolab/manual/blob/main/.github/ISSUE_TEMPLATE/induction.md
[coc]: https://github.com/compgeolab/manual/blob/main/CODE_OF_CONDUCT.md
[website]: https://www.compgeolab.org
[website-github]: https://github.com/compgeolab/website
[website-contrib]: https://github.com/compgeolab/website/blob/main/CONTRIBUTING.md
[swc]: https://software-carpentry.org/lessons/
[gh]: https://github.com/compgeolab/
[slack]: https://compgeolab.slack.com
[pii]: https://en.wikipedia.org/wiki/Personally_identifiable_information
[leo]: https://www.compgeolab.org/people/uieda.html
[liv-social]: https://www.liverpool.ac.uk/media/livacuk/computingservices/regulations/social-media-policy.pdf
[grad-health]: https://www.theatlantic.com/education/archive/2018/11/anxiety-depression-mental-health-graduate-school/576769/
[software-licenses]: https://doi.org/10.1109/MCSE.2009.19
[fatiando]: https://www.fatiando.org
[lazy-consensus]: https://rave.apache.org/docs/governance/lazyConsensus.html
