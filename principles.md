# Our practices and principles

This document outlines how we approach science, collaboration, and authorship.
**It is vital that you are aware of and agree with these principles to a large
extent if you want to work with us**.

> 💡 **Tip:** Use the [table of contents](https://github.blog/changelog/2021-04-13-table-of-contents-support-in-markdown-files/)
> icon on the top-left 👆🏽 to quickly navigate this document.

## Our stance on Open Science

**We have an open-by-default policy**, meaning that we assume that software and
data will be made openly available under permissive licenses
([CC-BY](https://creativecommons.org/licenses/by/4.0),
[BSD](https://opensource.org/licenses/BSD-3-Clause), etc.)
unless there is a  **very** good reason not to
([PII](https://en.wikipedia.org/wiki/Personally_identifiable_information) or
other restrictions).

General guidelines on openness:

* Work on software should be conducted in public repositories.
* Papers, dissertations, and research projects may be held back as private
  until time of first submission, when they should be made public for
  peer-review.
* Because most repositories will be made publicly accessible, including their
  entire history, lab members are required to behave professionally in them
  (including commit messages, issues, pull requests, code comments, etc).
* Many journals consider the content of referee reports to be confidential.
  Unless the report is explicitly open, it should **not** be added to
  repositories as text, commit messages, or comments in papers.
* Grant proposals developed internally with no external PIs or Co-PIs should be
  made available unless there is confidential information.
* Grant proposals developed in collaboration with external PIs or Co-PIs may be
  kept confidential at the external collaborators discretion, although our
  preference is for them to be open.

Data and code availability:

* All data and models generated by the lab will be made available in both raw
  and processed forms under
  [CC0](https://creativecommons.org/publicdomain/zero/1.0/) or
  [CC-BY](https://creativecommons.org/licenses/by/4.0) licenses.
* All software will be made available in source form under permissive,
  BSD-style licenses, unless constrained by external copyleft licensing.
* Source code will be made publicly available on GitHub (or similar),
  with additional backups possible.
* Every effort will be made to preserve integrity and accessibility of data.

> **Note:** The text above is based on the
> [GBMF DDD Data Sharing Plan](https://doi.org/10.6084/m9.figshare.1293561)
> by Matthew Turk.

Reproducibility:

* All necessary components to provide reproducibility of a scholarly work
  should be provided in a publicly accessible location and as part of the
  scientific record (e.g., by including DOIs to data archives in papers).
* The only exception is when strongly prohibited by external concerns (private
  or sensitive data, etc).
* Method development papers must include:
  1. The source code that implements the methodology.
  1. Analysis code that generated plots and results from the paper.
* The additional overhead of making work reproducible should not be onerous
  compared to the other expectations, and can actually reduce the overall
  effort of developing papers and workflows.
* We will endeavor to respond to requests to reproduce our results by providing
  necessary technology and data, allowing for reasonable commitments of time
  and effort.

## Authorship

The following guidelines apply to publications involving lab members.
**If you want to collaborate with the lab, please make sure you understand and
agree with them.**

* **We do not view authorship as a [zero-sum game](https://en.wikipedia.org/wiki/Zero-sum_game)**.
* Authorship in publications should be explicitly discussed between everyone
  involved **as early as possible**, ideally as soon as a project starts.
* Projects that lab members bring with them **do not** automatically confer
  authorship rights to either Leo or other lab members.
* However, if work is conducted on them during the course of being present in
  the lab, acknowledgments would be appreciated (funding acknowledgments are
  necessary).
* Projects that are collaborated on between lab members confer authorship to
  those directly involved, whether that collaboration is intellectual,
  technical, or data sharing. For example, writing code to support analysis or
  simulation would confer authorship.
* Sharing information during group meetings does not automatically confer
  authorship.
* If material intellectual contributions (i.e., new directions, solutions to
  problems, specific and directed project ideas) are made by lab members, that
  would confer authorship.

External collaborations:

* Please keep Leo apprised of the broad outlines of your external and internal
  collaborations.
* You do not have to involve Leo or grant him authorship in your external
  collaborations (though he will probably be happy to be involved if asked).

Project ownership (from a  social, rather than a licensing or intellectual
property perspective):

* When a project is developed in the lab primarily by a single participant,
  that participant is free to continue developing and assuming project
  leadership once they have departed the lab.
* Developing projects that mature, grow, and may contribute to their future
  career is a key part of the process of scientific development.
* For projects that are collaboratively developed with multiple roughly equal
  participants, leadership will be decided on a case-by-case basis. Preference
  is given to providing intellectual freedom and empowerment to earlier-stage
  researchers.
* Projects that are part of a strategic lab direction may continue to be
  developed within the lab following departure of a primary developer.
  Decisions about "forking" or bifurcating development will be held on a
  case-by-case basis.

## Ethics

Our actions should be guided by the ethics of participating in the scientific
community.
This means:

* Prioritizing our professional obligations over fear of being "scooped." For
  instance, it is unacceptable to interfere with the peer-review process for a
  paper out of concern of protecting one's own work (i.e., "sitting" on a
  review for it, making unreasonable requests to delay publication, and so on.)
* When other researchers request assistance with software developed in the lab,
  we should attempt to make a best effort to assist them. It is not
  unreasonable to ask for authorship, particularly if the collaboration is
  extensive.
* Provide citations to all software that assisted in the development of the
  scholarly work. In general it is acceptable to cite the layers of software in
  the analysis stack (e.g., NumPy, Matplotlib, IPython/Jupyter, Fatiando, etc.)
* Citations to data sources (DOIs and publications) should be made wherever
  possible, and where not possible, should be included as footnotes.
* Plagiarism is unacceptable in any form. This includes "first pass" text
  included in papers or proposals. If including text from an external source,
  it must be clearly marked as such to ensure it is not accidentally included
  in the final product.

## Coding and software

Strive to follow these standards:

* Code should avoid being "too clever", for example clever abuses of languages
  and algorithms that cut corners in the interest of marginal time savings.
* Clarity and maintainability take precedence over performance to ensure that
  the code can remain useful beyond the original scope of the project.
* Tests should be considered mandatory for new functionality and bug fixes.
  These tests should be part of automated testing suites.
* Use [black](https://github.com/psf/black) to automatically format Python code.
* Documentation must be added with any new code and should be accessible to
  newcomers. Include examples whenever possible.
* Comments (not including markdown cells in notebooks) are encouraged but not
  necessary. Code should be as self-describing as possible. Where complexity
  is inevitable, comments should allow anyone to  understand the shortcuts and
  reasoning.
* Include citations to algorithms whenever possible, including links to online
  resources.
* Docstrings should be added to all functions and classes in Python code.

Licensing:

* We value respect for licensing terms and ensuring that we comply with them at
  all times.
* All code generated in the lab should be open-source with a permissive
  (non-copyleft) license (MIT, BSD, etc).
* Our preferred license is [BSD 3-clause](https://opensource.org/licenses/BSD-3-Clause).
* If contributions to upstream copyleft (GPL, etc) projects are made, those
  contributions can be licensed in accordance with the upstream project license.
* For further discussion see [Stodden (2008)](https://doi.org/10.1109/MCSE.2009.19).

Languages:

* Use Python for most software.
* Experimenting with Julia and other languages is acceptable and even desirable.
* For code that needs to be optimized, the first preference is (in order):
  Numba, then Cython, and finally C.

Project leadership:

* When software is developed as a result of funded activity, the leadership
  directions will be set collaboratively during the proposal writing process and
  between lab members and Leo.
* For externally developed projects, leadership is as decided by the broader
  community.
* Decisions regarding strategic direction for software projects (including
  algorithmic strategies) will be made collaboratively.
* For technical directions on lab-developed software, we operate by
  ["lazy consensus"](https://rave.apache.org/docs/governance/lazyConsensus.html).

External projects:

* We strive to be good "citizens" of the broader open-source community.
* We encourage lab members to contribute upstream to open-source projects.
* Projects developed with external collaborators (e.g.,
  [Fatiando a Terra](https://www.fatiando.org)) should have their discussions
  held openly. This can help discourage the notion that projects developed by
  lab members are not community projects.
* For more discussion about this topic, see Matt Turk's paper
  [Scaling a Code in the Human Dimension](https://arxiv.org/abs/1301.7064).
